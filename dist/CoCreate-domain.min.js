!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CoCreate=t():(e.CoCreate=e.CoCreate||{},e.CoCreate.domain=t())}(this,(function(){return(()=>{var e={75:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var o=n(585),r=n.n(o);const i={attribute:"data-actions",actions:{},selectedStage:[],stageIndex:0,selectedElement:null,completedEventName:"completedEvent",__init:function(){this.actionButtonEvent()},actionButtonEvent:function(){const e=this;document.addEventListener("click",(function(t){let n=t.target;if(n.getAttribute("data-actions")||(n=t.target.closest("[data-actions]")),!n)return;t.preventDefault();let o=(n.getAttribute(e.attribute)||"").replace(/\s/g,"").split(",");0!=o.length&&(e.stageIndex=0,e.selectedStage=o,e.selectedElement=n,e.__runActionFunc())}))},init:function({action:e,callback:t,endEvent:n}){this.registerEvent(e,t,null,n)},registerEvent:function(e,t,n,o){if(this.actions[e])return;this.actions[e]={key:e,runFunc:t,instance:n||window,endEvent:o};for(let t in this.actions)if(t!=e&&this.actions[t].endEvent===o)return;const r=this;document.addEventListener(o,(function(e){r.__nextAction(o,e.detail)}))},__runActionFunc:function(e){if(this.stageIndex>=this.selectedStage.length)return void(this.stageIndex==this.selectedStage.length&&this.__runAtag(this.selectedElement));const t=this.selectedStage[this.stageIndex],n=this.actions[t];if(n)n.runFunc?n.runFunc.call(null,this.selectedElement,e):this.__nextAction(n.endEvent,{});else{"next"===this.__runSpecialAction(t,e)&&this.__moveNextAction()}},__nextAction:function(e,t){const n=this.selectedStage[this.stageIndex];n&&e===this.actions[n].endEvent&&this.__moveNextAction(t)},__runAtag:function(e){e.querySelector("a")},__runSpecialAction:function(e,t){let n=/(\w+)\{([a-zA-Z0-9_ \-#$.]+)\}/gm.exec(e);if(!n||n.length<3)return"next";let o=n[1],r=n[2].trim();if(!r)return"next";const i=this;switch(o){case"event":document.addEventListener(r,(e=>{i.__moveNextAction(e)}),{once:!0});break;case"timeout":parseInt(r)>0&&setTimeout((function(){i.__moveNextAction(t)}),parseInt(r));break;case"action":let e=document.querySelector(r);e&&e.click();break;default:return"next"}},__moveNextAction:function(e){this.stageIndex++,this.__runActionFunc(e)}};i.__init();const c=i,a={__getValueFromObject:function(e,t){try{if(void 0===e||!t)return!1;let n=e,o=t.split(".");for(let e=0;e<o.length;e++)if(n=n[o[e]],!n)return!1;return n}catch(e){return!1}},__getValue:function(e,t){let n=/{{\s*([\w\W]+)\s*}}/g.exec(t);return!!n&&this.__getValueFromObject(e,n[1].trim())},__createObject:function(e,t){try{if(!t)return e;let o=t.split("."),r=e;for(var n=o.length-1;n>=0;n--)r={[o[n]]:r};return r}catch(e){return!1}},__replaceValue:function(e,t){let n=!1,o=this,r=null,i=t.match(/{{([A-Za-z0-9_.,\[\]\- ]*)}}/g);return i&&(i.forEach((r=>{let i=o.__getValue(e,r);i&&"object"!=typeof i&&(n=!0,t=t.replace(r,i))})),n&&(r=t)),r},setArray:function(e,t){const n=e.getAttribute("data-render_array")||"data",o=e.getAttribute("data-render_key")||n,r=this,i=this.__getValueFromObject(t,n);n&&Array.isArray(i)&&i.forEach(((t,i)=>{let c=e.cloneNode(!0);c.classList.remove("template"),c.classList.add("clone_"+n);let a=o;"object"!=typeof t?a+="[]":t.index=i;let s=r.__createObject(t,a);r.setValue([c],s),e.insertAdjacentHTML("beforebegin",c.outerHTML)}))},setValue:function(e,t,n,o){if(!t)return;const r=this;Array.from(e).forEach((e=>{let o=e.getAttribute("data-pass_id");if(!n||o==n){if(Array.from(e.attributes).forEach((n=>{let o=n.name.toLowerCase(),i=n.value;if(i=r.__replaceValue(t,i),i){if("value"==o){switch(e.tagName.toLowerCase()){case"input":e.setAttribute(o,i);break;case"textarea":e.setAttribute(o,i),e.textContent=i;break;default:0===e.children.length&&(e.innerHTML=i)}}e.setAttribute(o,i)}})),0==e.children.length&&e.textContent){let n=e.textContent;n=r.__replaceValue(t,n),n&&(e.textContent=n)}e.children.length>0&&r.setValue(e.children,t),e.classList.contains("template")&&r.setArray(e,t)}}))},data:function({selector:e,data:t,elements:n,passTo:o}){e?this.render(e,t):n&&this.setValue(n,t,o)},render:function(e,t){let n=document.querySelector(e);n&&(Array.isArray(t)?(n.setAttribute("data-render_array","test"),this.setValue([n],{test:t})):this.setValue(n.children,t))}};let s=new(r())("api");const l={modules:{},init:function({name:e,module:t}){this.register(e,t)},register:function(e,t){const n=this;void 0===this.modules[e]&&(this.modules[e]=t,s.listen(e,(t=>{n.__responseProcess(e,t)})),Array.isArray(t.actions)&&t.actions.forEach((e=>{"function"!=typeof t[`action_${e}`]&&(t[`action_${e}`]=function(o){n.__commonAction(t.id,e,o)}),c.init({action:e,endEvent:e,callback:n=>{t[`action_${e}`](n)}})})))},__responseProcess:function(e,t){const{type:n,response:o}=t,r=this.modules[e];n&&o&&r&&("function"==typeof r[`render_${n}`]&&r[`render_${n}`](o),this.render(n,o),document.dispatchEvent(new CustomEvent(n,{detail:{data:o}})))},__commonAction:function(e,t,n){const o=n.closest("form")||document;let r=l.getFormData(e,t,o);l.send(e,t,r)},getFormData:function(e,t,n){const o=`data-${e}`,r=this,i=n.querySelectorAll(`[${o}^="${t}."]`);let c={};i.forEach((n=>{let i=n.getAttribute(o),a=n.getAttribute(o+"_array"),s=r.__getElValue(n);if(i){if(t){let e=new RegExp(`^${t}.`,"i");if(!e.test(i))return;i=i.replace(e,"")}a?(c[i]||(c[i]=[]),c[i].push(r.getFormData(e,a,n))):null!=s&&(c[i]=s)}}));let a=Object.keys(c),s={};return a.forEach((e=>{if(e.split(".").length>1){let t=r.__createObject(c[e],e);delete c[e],s=r.__mergeObject(s,t)}else s[e]=c[e]})),s},__getElValue:function(e){let t=null;if(void 0!==e.value)switch(e.type.toLocaleLowerCase()){case"checkbox":e.checked&&(t=e.value);break;default:t=e.value}else t=e.getAttribute("value"),t||(t=e.innerHTML);return t},__mergeObject:function(e,t){e=e||{};for(let n of Object.keys(t))t[n]instanceof Object&&Object.assign(t[n],this.__mergeObject(e[n],t[n]));return Object.assign(e||{},t),e},__createObject:function(e,t){if(!t)return e;let n=t.split("."),o=e;for(var r=n.length-1;r>=0;r--)o={[n[r]]:o};return o},send:function(e,t,n){let o=this.getCommonParamsExtend(n||{});o={...o,data:n},s.send(e,{type:t,data:o})},render:function(e,t){a.data({selector:`[data-template_id="${e}"]`,data:t})},createApiSocket:function(e,t){t?(s.create({namespace:t,room:null,host:e}),s.setGlobalScope(t)):s.create({namespace:null,room:null,host:e})},getCommonParamsExtend:function(e){return{apiKey:e.apiKey||config.apiKey,securityKey:e.securityKey||config.securityKey,organization_id:e.organization_id||config.organization_Id}}};l.createApiSocket(window.config.host?window.config.host:"server.cocreate.app",window.config.organization_Id);const u=l},946:function(e,t,n){var o,r;"undefined"!=typeof self&&self,o=[n(75)],void 0===(r=function(e){return e}.apply(t,o))||(e.exports=r)},446:function(e,t){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(e){function t(){let t={};return e&&e.config&&(t=e.config),{apiKey:t.apiKey,organization_id:t.organization_Id}}function n(t){let n={};return e&&e.config&&(n=e.config),{apiKey:t.apiKey||n.apiKey,organization_id:t.organization_id||n.organization_Id}}function o(t,n){let o={};e&&e.config&&(o=e.config);let r=t||o.organization_Id,i=n||"";return i?`${r}/${i}`:r}return{getCommonParams:t,getCommonParamsExtend:n,generateSocketClient:o}}(window)}.apply(t,[]))||(e.exports=n)},585:function(e,t,n){var o,r;"undefined"!=typeof self&&self,o=[n(446),n(212)],void 0===(r=function(e,t){return function(e,t,n,o,r){class i{constructor(e="crud"){this.prefix=e||"crud",this.sockets=new Map,this.listeners=new Map,this.messageQueue=new Map,this.saveFileName="",this.globalScope=""}setGlobalScope(e){this.globalScope=`${this.prefix}/${e}`}getGlobalScope(){return this.globalScope}create(e){const{namespace:r,room:i}=e,c=this.getKey(r,i);let a,s=this;if(r&&this.setGlobalScope(r),this.sockets.get(c))return void(a=this.sockets.get(c));let l=t.location.protocol;"about:"===t.location.protocol&&(l=t.parent.location.protocol,e.host||(e.host=t.parent.location.host));let u="http:"===l?"ws":"wss";const d=e.port?e.port:8088;let f=`${u}://${t.location.host}:${d}/${c}`;e.host&&(f=e.host.includes("://")?`${e.host}/${c}`:e.host.includes(":")?`${u}://${e.host}/${c}`:`${u}://${e.host}:${d}/${c}`);try{let e=null;t.localStorage&&(e=t.localStorage.getItem("token")),a=new n(f,e),a.cocreate_connected=!1,this.sockets.set(c,a)}catch(e){return}a.onopen=function(e){a.cocreate_connected||(a.cocreate_connected=!0),(s.messageQueue.get(c)||[]).forEach((e=>a.send(JSON.stringify(e)))),s.messageQueue.set(c,[])},a.onclose=function(t){switch(t.code){case 1e3:break;default:s.destroy(a,c),s.reconnect(a,e)}},a.onerror=function(t){s.destroy(a,c),s.reconnect(a,e)},a.onmessage=function(e){try{if(t.Blob&&e.data instanceof o)return void s.saveFile(e.data);let n=JSON.parse(e.data);if(n.data&&(n.data.uid&&s.__fireEvent(n.data.uid,n.data),n.data.event))return void s.__fireEvent(n.data.event,n.data);n.action;const r=s.listeners.get(n.action);if(!r)return;r.forEach((e=>{e(n.data,c)}))}catch(e){}}}__fireEvent(e,n){if(t.CustomEvent){var o=new t.CustomEvent(e,{detail:n});t.document.dispatchEvent(o)}else process.emit(e,n)}send(e,t,n){const o=r.generate(),i={action:e,data:{...t,uid:o}},c=this.getKeyByRoom(n),a=this.getByRoom(n);return a&&a.cocreate_connected?a.send(JSON.stringify(i)):this.messageQueue.get(c)?this.messageQueue.get(c).push(i):this.messageQueue.set(c,[i]),o}sendFile(e,t){const n=this.getByRoom(t);n&&n.send(e)}listen(e,t){this.listeners.get(e)?this.listeners.get(e).push(t):this.listeners.set(e,[t])}reconnect(e,t){let n=this;setTimeout((function(){n.create(t)}),1e3)}destroy(e,t){e&&(e.onerror=e.onopen=e.onclose=null,e.close(),e=null),this.sockets.get(t)&&this.sockets.delete(t)}destroyByKey(e){let t=this.sockets.get(e);t&&this.destroy(t,e)}getKey(e,t){let n=`${this.prefix}`;return e&&""!=e&&(n+=t&&""!=t?`/${e}/${t}`:`/${e}`),n}getByRoom(e){let t=this.getKeyByRoom(e);return this.sockets.get(t)}getKeyByRoom(e){let t=this.globalScope;return e&&(t=`${this.prefix}/${e}`),t}saveFile(e){if(t.document){const o=this.saveFileName||"downloadFile";var n=t.document.createElement("a");t.document.body.appendChild(n),n.style="display: none";let r=window.URL.createObjectURL(e);n.href=r,n.download=o,n.click(),t.URL.revokeObjectURL(r),this.saveFileName=""}}listenAsync(e){return new Promise(((n,o)=>{let r=setTimeout((()=>{clearTimeout(r),n(null)}),5e3);t.document?t.document.addEventListener(e,(function(e){n(e.detail)}),{once:!0}):process.once(e,(e=>{n(e)}))}))}}return i}(0,window,WebSocket,Blob,t)}.apply(t,o))||(e.exports=r)},212:function(e,t){var n;"undefined"!=typeof self&&self,void 0===(n=function(){return function(e){const t={attribute:"data-uuid",init:function(t){if(!e.document)return;const n=t||e.document;if(!n.querySelectorAll)return;let o=n.querySelectorAll(`[${this.attribute}]`);const r=this;o.forEach((e=>{const t=parseInt(e.getAttribute(r.attribute))||36,n=r.generate(t);"INPUT"===e.tagName||"TEXTAREA"===e.tagName?e.value=n:e.innerHTML=n}))},generate:function(t=36){let n=(new Date).getTime(),o=e.performance&&e.performance.now&&1e3*e.performance.now()||0,r="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";if(t<=r.length)r=r.substr(0,t);else{let e=t-r.length,n="-xxxyyxxx",o=Math.floor(e/n.length);for(let e=0;e<o;e++)r+=n;o=e-o*n.length,r+=n.substr(0,o)}return r.replace(/[xy]/g,(function(e){var t=16*Math.random();return n>0?(t=(n+t)%16|0,n=Math.floor(n/16)):(t=(o+t)%16|0,o=Math.floor(o/16)),("x"==e?t:7&t|8).toString(16)}))}};return t.init(),t}(window)}.apply(t,[]))||(e.exports=n)},417:(e,t,n)=>{"use strict";var o;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;const r={id:"domain",actions:["cnameRecord","cnameRecordDelete","contactRecord","contactRecordDelete","customerRecord","customerRecordDelete","ipv4Record","ipv6Record","mxRecord","mxRecordDelete","nsRecord","registerRecord","txtRecord","txtRecordDelete","executeAction"],render_cnameRecord:function(e){},render_cnameRecordDelete:function(e){},render_contactRecordDelete:function(e){},render_contactRecordDelete:function(e){},render_customerRecord:function(e){},render_customerRecordDelete:function(e){},render_ipv4Record:function(e){},render_ipv6Record:function(e){},render_mxRecord:function(e){},render_mxRecordDelete:function(e){},render_nsRecord:function(e){},render_registerRecord:function(e){},render_searchRecord:function(e){},render_txtRecord:function(e){},render_txtRecordDelete:function(e){},render_executeAction:function(e){alert(e.id),document.getElementById(e.id).click()}};((o=n(946))&&o.__esModule?o:{default:o}).default.init({name:r.id,module:r});var i=r;t.default=i},352:(e,t,n)=>{"use strict";var o,r;"undefined"!=typeof self&&self,o=[n(417)],void 0===(r=function(e){return e}.apply(t,o))||(e.exports=r)}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o=n(352);return o=o.default})()}));